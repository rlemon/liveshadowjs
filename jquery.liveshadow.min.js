$.fn.liveShadow=function(a){var n=function(e,c,d,f){var k=1,l=1,m=5,g=[],h=4*Math.cos(d);d=4*Math.sin(d);for(var b=0;b<c/4;b++)k=b*h,l=b*d,m+=0.75,g.push(k+"px "+l+"px "+m+"px rgba("+f.r+","+f.g+","+f.b+","+(f.a-b/(c/4))+")");e.style[a.type+"Shadow"]=g.join(",")},p=function(a){a=a.replace(/#/,"");3===a.length&&(a=a.replace(/./g,"$&$&"));a=parseInt(a,16);return{r:a>>16,g:a>>8&255,b:a&255}},q=function(a,c){var d=0.3*a.r+0.59*a.g+0.11*a.b;return{r:d*c+a.r*(1-c)|0,g:d*c+a.g*(1-c)|0,b:d*c+a.b*(1-c)|0}},
r=function(e){var c="text"===a.type?"color":"backgroundColor";e=window.getComputedStyle(e)[c].match(/\d+/g).map(Number);return{r:e[0],g:e[1],b:e[2]}};a=$.extend({shadowLength:70,opacity:0.7,type:"box",color:null,distance:document.body.offsetWidth/4,angle:45,desaturate:0.1,invert:!1,isStatic:!1},a);"string"===typeof a.color&&(a.color=p(a.color));a.color&&a.color.a&&(a.opacity=a.color.a);a.constAngle=Math.PI/180*90;return this.each(function(){var e,c,d,f=this,k=function(a){e=f.offsetWidth/2;c=f.offsetHeight/
2;d=$(f).offset()},l=a.color||q(r(this),a.desaturate),m=function(g){var h=d.left-g.clientX+e,b=d.top-g.clientY+c;g=a.constAngle-Math.atan2(h,b);b=Math.sqrt(h*h+b*b)+45;h=b<a.distance?b/a.distance*a.shadowLength:a.shadowLength;b=$.extend({a:b<a.distance?b/a.distance*a.opacity:a.opacity},l);console.log(d.left);a.invert&&(g*=-1);n(f,h,g,b)};k();n(f,a.shadowLength,a.constAngle-a.angle,$.extend({a:a.opacity},l));if(!a.isStatic)$(window).on("resize",k).on("mousemove touchmove",m)})};